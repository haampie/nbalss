\documentclass[a4paper]{article}

\usepackage{amsmath, amssymb}
\usepackage{listings}
\usepackage{courier}
\usepackage{color}
\usepackage{pgfplots}
\usepackage{subcaption}


\pgfplotsset{compat=newest}
\usetikzlibrary{plotmarks}
\usetikzlibrary{arrows.meta}
\usepgfplotslibrary{patchplots}

\definecolor{light-gray}{gray}{0.7}

\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

\author{H.T. Stoppels (University of Groningen)}
\title{{\sc nbalss} homework 2}

\lstdefinestyle{myCustomMatlabStyle}{
  language=Matlab,
  tabsize=4,
  showspaces=false,
  showstringspaces=false
}

\begin{document}
  \maketitle
  
  The buckling problem for $\phi = \phi(s)$ is the non-linear ODE
  \begin{equation}\label{eq:problem}
  \begin{aligned}
    \phi^{\prime\prime} + \mu \sin \phi &= 0 \text{ on } (0, 1) \\
    \phi(0) &= 0 \\
    \phi(1) &= 0.
  \end{aligned}
  \end{equation}

  \paragraph{1} For any $\mu \in \mathbb{R}$ it is clear that the trivial solution $\phi \equiv 0$ satisfies~\eqref{eq:problem}.

  \paragraph{2} Using the Taylor expansion $\sin x = x + O(x^2)$ around $x = 0$ we obtain the linearized version of~\eqref{eq:problem} as $$\phi^{\prime\prime} = - \mu \phi$$
  which has the solutions $\phi(s) = \sin(\sqrt{\mu}s)$ which satisfies the boundary condition at $s = 1$ if and only if $\mu = n^2\pi^2$ for $n \in \mathbb{N}.$

  \paragraph{3} Let $n$ be the number of segments, $h := 1 / n$ the mesh-width and $\phi_j$ an approximation to $\phi(x_j)$ for $x_j = (j-\tfrac{1}{2})h$ for all $j = 1, \dots, n.$ We have $\phi_{-1/2} = \phi_{n + 1/2} = 0,$ so the finite difference equations read
  \begin{equation}
    \phi_{i-1} - 2 \phi_i + \phi_{i + 1} + h^2 \mu \sin \phi_i = 0 \text{ for } i = 1, \dots, n - 1
  \end{equation}
  for the non-linear case, and
  \begin{equation}
    \phi_{i-1} + (-2 + h^2 \mu)\phi_i + \phi_{i + 1} = 0 \text{ for } i = 1, \dots, n - 1
  \end{equation}
  for the linearized case.

  \paragraph{4}
\end{document}